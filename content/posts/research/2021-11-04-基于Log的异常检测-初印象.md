---
date: "2021-11-04 16:18:31"
tags: 
categories: 
draft: true
title: "基于Log的异常检测-初印象"
---

快速了解：

1. 想要解决什么问题
2. 具体用什么方法
3. 效果怎么样

DeepLog是李飞飞团队的文章，基于lSTM。

## 实现原理

每一行日志都是源代码的输出语句生成的。比如某个进程的源代码中的日志打
印语句为`printf("Accepted password for %s from %s port %d ssh2 \n", user, host, port)`，那么在程序的运行过程中，就可能会产生`Feb 28 04:48:54 combo sshd(pam_unix)[6741]: Accepted password for root from 112.64.243.186 port 2371 ssh2`。一条源代码打印出的日志为同一类型，其代码称为日志键。

系统产生的日志是有一定的逻辑性的，比如下面几条日志：

系统产生的日志是有一定的逻辑性的，比如下面几条日志：

```shell
1 Jun 26 04:10:02 combo su(pam_unix)[1546] session opened for user news by (uid=0)
2 Jun 26 04:10:04 combo su(pam_unix)[1546] session closed for user news
3 Jun 27 04:02:47 combo su(pam_unix)[7031] session opened for user cyrus by (uid=0)
4 Jun 27 04:02:48 combo su(pam_unix)[7031] session closed for user cyrus
```

相邻或者相近日志的关联度很高，一条日志往往取决于前一条或者前几条日志，当这种逻辑性被某条日志打破，则说明发生了日志执行路径异常。

因此我们可以将日志执行顺序看作成一个多分类问题，日志键的总数是一定的，我们看作为K，在训练阶段我们输入正常的日志执行序列，生成一个多分类器模型。在测试阶段，我们输入最近日志键的历史记录，输出是一个日志键的概率分布。如下图所示:

![img](https://saucer-man.com/usr/uploads/2020/06/206670244.png)

