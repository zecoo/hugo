<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="Hugo 0.58.3" />
    <meta name="description" content="好记性也要烂笔头">
    <title>
       暴躁老农  
    </title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://zecoo.github.io/hugo/css/main.css">
    <link rel="stylesheet" href="https://zecoo.github.io/hugo/css/github.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
</head>
  <body>
    
    

    
    

    

    <div class="container">
      <div class="row">
        <div class="blog-main">
        	<article class="blog-post">
			  <header>
			    <a href="https://zecoo.github.io/hugo/"><h2 class="blog-post-title" dir="auto"></h2></a>
			    <p class="blog-post-meta"><time datetime="0001-01-01T00:00:00Z">Mon Jan 1, 0001</time></p>
			  </header>
			  <p>各位老师下午好，我是19级软件工程专业的张泽锟，我的导师是孙世磊教授。下面开始我的中期考核汇报。</p>

<p>首先是思想方面，2019年12月我完成入党积极分子党校学习，今年10月开始发展对象课程培训。入党流程在顺利进行中。另外实验室诞生了“爱服务党支部”AI Service，爱服务党支部的宗旨是》〉。我积极参与支部各项活动，如参观学习科技馆党史、观看抗击疫情表彰大会等。</p>

<p>心理方面，研究生生活针对就业、科研等稍微有一点焦虑，但是都可以自我调节好。</p>

<p>然后是学习方面</p>

<p>经过一年的学习，我已完成硕士期间所有学分课程学习。要求32学分，完成33学分。另外所有成绩均在B及以上，62.5%的课程成绩在90分以上，加权平均为89分。</p>

<p>科研方面，在一年多的学习生活中，我积极开展论文调研、整理和总结工作，阅读研究领域相关论文近百篇，在组会及课堂上对十余篇论文作介绍或总结。在导师的指导下现已确定研究方向，并对研究方向的发展近况、相关工作、研究方法等都有一定的了解。并在此基础上创新，实验显示效果相对其他baseline方法在不同的角度有一点提升。目前正在整理实验。下面我简单介绍一下我的研究</p>

<p>我做的东西叫微服务系统的根因定位，简单来说就是定位微服务系统中异常的节点。</p>

<p>传统的单体软件系统如果出现异常，寻找异常解决问题的过程被称为debug。这个过程需要花费大量的时间成本和人力成本。随着单体软件系统的继续扩大，debug的成本也会越来越高。在这样的前提下，微服务系统越来越受到工业界的认可，通过将大型的单体架构拆分成多个可以独立部署，微服务以REST或RPC的通信方式相互协作。只需要针对具体出问题的微服务进行debug，大大降低了解决问题的复杂度。但同时微服务系统也带来了一些问题，由于微服务数量较多，且微服务之间相互协作的复杂度较高，如果其中一个微服务出现异常，会牵连到与其协作的微服务均出现不同程度的异常。可能是服务响应时间变高，甚至有可能是某个调用过程被切断。根因定位就是为了解决该类问题，在出现异常的时候快速定位出现异常的微服务节点。</p>

<p>当前研究面临的挑战有：</p>

<ol>
<li>微服务系统伸缩灵活，一个微服务可以有很多副本，这样系统中的节点数量较多增加了定位难度</li>
<li>监控指标多，服务的相应时间、主机的cpu、内存等、另外微服务是运行在容器里的，容器的cpu、内存也属于监控指标。</li>
<li>高度的动态环境，由于微服务系统伸缩灵活，一个服务的ip往往是动态变化的，这也给定位添加了困难。</li>
<li>数据实时变化，收集到的监控指标是实时变化的，这就要求定位方法在变化中要保证一定的准确率。</li>
</ol>

<p>一般的根因定位方法，首先会收集各种监控指标，然后根据微服务之间的网络调用信息构造服务调用图，与此同时会根据异常检测方法判断微服务节点是否出现异常。一般的方法中认为一般意识到异常的发生都是在前端节点发现的，所以根据节点和前端frontend节点之间的相似度对候选集中的异常节点进行排序，排序越高的越可能是异常节点。</p>

<p>下面绿色的表格表示了如何判断节点之间的相似度，首列是微服务，后面的数据表示的是收集到的相应时间变化，可以根据Pearson相关系数直接计算两个微服务之间的相似度。可以看出frontend节点和微服务2是最相似的。</p>

<p>下面说一下我觉得可以改进的地方</p>

<p>首先是inbound和outbound，分别表示服务A请求服务B的时间和服务B相应服务A的时间。</p>

<p>如果一个服务出现异常，那么请求该服务的时间还是正常的，但是该服务响应其他服务的时间就会变长。就像图中所示的，可以看到frontend-carts和orders-carts两个部分，carts响应其他服务的时间有明显的变化，carts出现异常的可能性就比较大</p>

<p>那么判断一个服务是否有异常呢，还是之前那个绿色的表格，我们把所有的服务的相应时间序列在坐标中表示出来，正常的服务在坐标中的波动程度是相似的，而异常的服务的波动程度会跟其他的微服务有较大的出入。</p>

<p>这个时候我们用计算不同时间序列距离的方式来判断是否出现异常，出现异常的话服务的相应时间之间的距离就会很大。</p>

<p>如果单单用inbound和outbound来对异常进行排序会遇到一些问题，第一个是在微服务系统里，有一个Gateway角色的微服务，几乎所有的服务都从gateway进行访问，那么如果有一个微服务的相应时间变长，那么gateway的相应时间也会变长。这样准确率就会受到影响，所以我们要降低gateway的权重。</p>

<p>第二个是我们发现一次访问肯定有一个trace，trace上如果有微服务出现异常，那么肯定会影响到异常节点到前端节点的trace上的所有节点。我们将这部分节点的异常情况累加到末端异常节点，提高准确率。</p>

<p>在获得了每个节点的异常指数之后，最后我们再次结合图的信息进行排序。首先说一下pagerank算法，</p>

<p>如左边的图所示，如果一个网页被很多其他网页链接到的话说明这个网页比较重要，也就是PageRank值会相对较高。</p>

<p>用这个方法我们可以找到图中最重要的节点，也就是入链最多的节点。随后有人提出了PageRank的其他版本，其中一个是 Personalized pagerank。个性化的pagerank跟传统pagerank不同的是，每次重新游走时，总是从选定节点开始（在为我们这里选择前端节点）。另外，游走到每个节点的权重是可以提前预设好的。之前获得的每个节点的异常指数，可以作为用在个性化的pagerank里。个性化的PageRank会返回一个和前端节点相似度的节点排序，排序最高的就是最可能的异常节点。</p>

<p>我们回顾一下整体的方法：</p>

<p>首先获取主机、容器、微服务的各项监控指标，然后通过各项指标的时间序列进行异常检测和服务调用图的构建。在这两个基础上，计算每个微服务节点的异常指数，将异常指数作为个性化pagerank的权重，在调用图上使用个性化pagerank算法对所有节点进行排序，排序最高的就是最可能的异常节点。</p>

<p>实验的准备，</p>

<p>最后是实验的结果。左上角的第一幅图表示的是准确率。准确率用的是两个指标，Precision@K和MAP，</p>

			</article>
        </div> 
      </div> 
    </div>

    
    
    

    <script src="https://zecoo.github.io/hugo/js/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>