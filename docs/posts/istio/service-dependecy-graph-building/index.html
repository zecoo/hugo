<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="Hugo 0.58.3" />
    <meta name="description" content="好记性不如烂笔头">
    <title>
        Service Dependecy Graph Building 
    </title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://zecoo.github.io/hugo/css/classes.css">
    <link rel="stylesheet" href="https://zecoo.github.io/hugo/css/github.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
</head>

  <body>
    
    

    
    

    

    <div class="container">
      <div class="row">
        <div class="blog-main">
        	<article class="blog-post">
			  <header>
			    <h2 class="blog-post-title" dir="auto">Service Dependecy Graph Building</h2>
			    <p class="blog-post-meta"><time datetime="2020-05-26T00:00:00+08:00">Tue May 26, 2020</time></p>
			  </header>
			  

<p>kiali是trace的一个可视化工具，那么我怎么才能拿到trace的原始数据呢？</p>

<p>istio的数据也都是prom给的，prom的metric之前已经看过了。怎么从prom的metric构造一个trace处理呢？</p>

<p>Istio中Jaeger的数据是临时存在内存里的。</p>

<p>Envoy的日志可以收集到，我又可以了。</p>

<pre><code class="language-shell">root@1201:istio-1.4.3 $ kubectl logs -l app=productpage -c istio-proxy
[2020-05-28T09:17:49.996Z] &quot;GET /static/bootstrap/js/bootstrap.min.js HTTP/1.1&quot; 200 - &quot;-&quot; &quot;-&quot; 0 37045 241 240 &quot;10.244.0.1&quot; &quot;Mozilla/5.0 (apple-x86_64-darwin19.0.0) Siege/4.0.4&quot; &quot;11bc5f08-0c8e-4a16-b0a5-b2c3f8900a4f&quot; &quot;39.100.0.61:30681&quot; &quot;127.0.0.1:9080&quot; inbound|9080|http|productpage.default.svc.cluster.local - 10.244.0.160:9080 10.244.0.1:0 - default
[2020-05-28T09:17:48.036Z] &quot;GET /productpage HTTP/1.1&quot; 200 - &quot;-&quot; &quot;-&quot; 0 5179 2201 2201 &quot;10.244.0.1&quot; &quot;Mozilla/5.0 (apple-x86_64-darwin19.0.0) Siege/4.0.4&quot; &quot;55cf1e7f-c6f7-41b0-9295-e3f72ecf5282&quot; &quot;39.100.0.61:30681&quot; &quot;127.0.0.1:9080&quot; inbound|9080|http|productpage.default.svc.cluster.local - 10.244.0.160:9080 10.244.0.1:0 - default
</code></pre>

<h2 id="参考">参考</h2>

<p><a href="https://blog.csdn.net/qq_42038407/article/details/103510066">https://blog.csdn.net/qq_42038407/article/details/103510066</a> （深入istio源码查看kiali的数据来源）</p>

<p><a href="https://www.cnblogs.com/loveis715/p/5277051.html">https://www.cnblogs.com/loveis715/p/5277051.html</a> （neo4j介绍好文）</p>

<p><a href="https://juejin.im/entry/5b0aa414f265da0ddf04a894">https://juejin.im/entry/5b0aa414f265da0ddf04a894</a> (nodeport可以用来画图)</p>

<p><a href="https://pjw.io/articles/2018/05/18/jaeger-tutorial/">https://pjw.io/articles/2018/05/18/jaeger-tutorial/</a> （Jaeger好文）</p>

<p><a href="https://yq.aliyun.com/articles/514488?utm_content=m_43347">https://yq.aliyun.com/articles/514488?utm_content=m_43347</a> （理解jaeger极好的图）</p>

<p><a href="https://packyzbq.gitee.io/jaeger-istio.html">https://packyzbq.gitee.io/jaeger-istio.html</a> （Istio中Jaeger的数据存储）</p>

<p><a href="https://github.com/IgaguriMK/envoy-dummy-stats/blob/master/sample/envoy-stats.txt">https://github.com/IgaguriMK/envoy-dummy-stats/blob/master/sample/envoy-stats.txt</a> （帮助理解envoy的奇怪PromQL）</p>

			</article>
        </div> 
      </div> 
    </div>

    
    
    

    <script src="https://zecoo.github.io/hugo/js/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>